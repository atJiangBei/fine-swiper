!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).FineSwiper={})}(this,(function(e){"use strict";const t=e=>e instanceof TouchEvent;class i{constructor(e){const{root:i,moveCallback:s=(()=>{}),startCallback:n=(()=>{}),endCallback:a=(()=>{})}=e;this.hasMove=!0,this.isStart=!1,this.root=i;const o=[];let l=0,h=0,d=0,c=0,r=0;var m;this.startMethod=e=>{this.hasMove=!1,this.isStart=!0,"mousedown"===e.type&&e.preventDefault();const i=t(e)?e.touches[0]:e,{clientX:s,clientY:a}=i;c=s,r=a,h=s,d=a,l=e.timeStamp,n({startX:s,startY:a,event:e})},this.moveMethod=e=>{if(this.hasMove=!0,!this.isStart)return;const i=t(e)?e.touches[0]:e,{clientX:n,clientY:a}=i;s({movedX:n-c,movedY:a-r,stepX:n-h,stepY:a-d,event:e}),h=n,d=a,o.length>20&&o.splice(0,10),o.push(e),l=e.timeStamp},this.endMethod=e=>{if(!this.isStart)return;if(this.isStart=!1,!this.hasMove)return void(this.hasMove=!0);let i=0,s=0;if(e.timeStamp-l<=100){const e=o.length-1;let n=e;for(let t=e;t>=0;t--){o[t].timeStamp+100>l&&(n=t)}if(n!==e){const a=o[e].timeStamp-o[n].timeStamp,l=o[n],c=t(l)?l.touches[0]:l,{clientX:r,clientY:m}=c;i=(h-r)/a*(1e3/60),s=(d-m)/a*(1e3/60)}}const n=t(e)?e.changedTouches[0]:e,{clientX:m,clientY:u}=n;a({movedX:m-c,movedY:u-r,speedX:i,speedY:s,event:e}),h=0,d=0,c=0,r=0,l=0,o.length=0},function(e,t){e.addEventListener("touchstart",t),e.addEventListener("mousedown",t)}(i,this.startMethod),m=this.moveMethod,document.addEventListener("touchmove",m),document.addEventListener("mousemove",m),function(e,t){document.addEventListener("touchend",t),document.addEventListener("touchcancel",t),document.addEventListener("mouseup",t)}(0,this.endMethod)}destroy(){var e,t;e=this.root,t=this.startMethod,e.removeEventListener("touchstart",t),e.removeEventListener("mousedown",t),function(e,t){document.removeEventListener("touchmove",t),document.removeEventListener("mousemove",t)}(this.root,this.moveMethod),function(e,t){document.removeEventListener("touchend",t),document.removeEventListener("touchcancel",t),document.removeEventListener("mouseup",t)}(this.root,this.endMethod)}}const s=e=>new i(e);class n{constructor(e){if(this.options=e,this.root=e.root,this.direction=e.direction||"horizontal",this.slideChange=e.slideChange||(e=>{}),this.disabledHandSlideing=!!e.disabledHand,this.loop=!e.scaleValue&&(!!e.loop&&e.loop),this.scaleValue=e.scaleValue||this.getSize(),this.slideContainer=this.root.children[0],!this.slideContainer)throw new Error("Rolling containers are indispensable");if(1!==this.slideContainer.nodeType)throw new Error("The scroll container must be an element");this.slideList=this.slideContainer.children,this.length=this.slideList.length,this.length<2?console.warn("The scroll container must have at least one child element"):(this.index=e.index||0,this.init(),this.touchInstance=s({root:this.root,startCallback(e){},moveCallback:e=>{this.setSlideDistanceByStep(e),this.setTranslate()},endCallback:e=>{this.__toNextCycle(e)}}))}init(){this.rePlanningElements(),this.setSlideDistanceByIndex(),this.setTranslate(),this.maxSlideDistance=this.getMaxSlideDistance(),this.setAnimateSped()}resize(){this.scaleValue=this.options.scaleValue||this.getSize(),this.setSlideDistanceByIndex(),this.setTranslate(),this.maxSlideDistance=this.getMaxSlideDistance(),this.setAnimateSped()}reinitialize(){const{loop:e}=this;if(e){const e=this.slideContainer.children,t=e.length;if(t<4);else{const i=e[0],s=e[t-1];this.slideContainer.removeChild(i),this.slideContainer.removeChild(s),this.slideList=this.slideContainer.children,this.length=this.slideList.length,this.rePlanningElements(),this.setSlideDistanceByIndex(),this.setTranslate(),this.maxSlideDistance=this.getMaxSlideDistance()}}else this.slideList=this.slideContainer.children,this.length=this.slideList.length,this.maxSlideDistance=this.getMaxSlideDistance()}destroy(){this.touchInstance.destroy()}setAnimateSped(){const e=this.scaleValue;this.animateSped=Math.ceil(e/800*30)}rePlanningElements(){const{loop:e,slideContainer:t,slideList:i,length:s}=this;if(e){const e=i[0],n=e.cloneNode(!0),a=i[s-1].cloneNode(!0);t.appendChild(n),t.insertBefore(a,e)}}setSlideDistanceByStep(e){const{stepX:t,stepY:i}=e;"vertical"===this.direction?this.slideDistance+=i:this.slideDistance+=t}setSlideDistanceByIndex(){let{index:e,loop:t,scaleValue:i}=this;t&&(e+=1),this.slideDistance=-i*e}setTranslate(){const{direction:e,slideContainer:t,slideDistance:i}=this;"horizontal"===e&&(t.style.transform="translate3d("+i+"px,0,0)"),"vertical"===e&&(t.style.transform="translate3d(0,"+i+"px,0)")}__toNextCycle(e){const{direction:t,animateSped:i}=this,{movedX:s,movedY:n,speedX:a,speedY:o}=e,l="vertical"===t?o:a,h="vertical"===t?n:s;if(this.cancelAnimation(),Math.abs(l)>10){const e=this.__getNextCriticalValue(h);this.startAnimation(this.slideDistance,e,i,(e=>{this.slideDistance=e,this.setTranslate()})).then((()=>{this.setIndexBySlideDistance(),this.rescheduleSlidingDistance()}))}else{const e=this.__getPrevCriticalValue(h);this.startAnimation(this.slideDistance,e,i,(e=>{this.slideDistance=e,this.setTranslate()})).then((()=>{this.setIndexBySlideDistance(),this.rescheduleSlidingDistance()}))}}__getNextCriticalValue(e){const{scaleValue:t,slideDistance:i,maxSlideDistance:s}=this;if(i>0)return 0;let n=Math.abs(i/t);return e<0?n=Math.ceil(n):e>0&&(n=Math.floor(n)),-Math.min(n*t,s)}__getPrevCriticalValue(e){const{scaleValue:t,slideDistance:i,maxSlideDistance:s}=this;if(i>0)return 0;const n=Math.round(Math.abs(i/t));return-Math.min(n*t,s)}toPrevPage(){this.slideDistance+=20,this.__toNextCycle({movedX:20,movedY:20,speedX:20,speedY:20})}toNextPage(){this.slideDistance-=20,this.__toNextCycle({movedX:-20,movedY:-20,speedX:-20,speedY:-20})}toPage(e){const{length:t,scaleValue:i,index:s}=this;if(e=Math.min(e,t-1),(e=Math.max(0,e))===s)return;const n=e>s?-1:1,a={movedX:20*n,movedY:20*n,speedX:20*n,speedY:20*n},o=s-e;this.slideDistance+=(o-n)*i,this.slideDistance+=20*n,this.__toNextCycle(a)}setIndexBySlideDistance(){const{loop:e,slideDistance:t,scaleValue:i,length:s}=this;let n=Math.ceil(Math.abs(t/i));e&&(n-=1,n>=s?n=0:n<0&&(n=s-1));this.index!==n&&(this.index=n,this.slideChange(n))}rescheduleSlidingDistance(){const{loop:e,slideDistance:t,scaleValue:i,length:s}=this;let n=Math.ceil(Math.abs(t/i));e&&(n-=1,n>=s?this.slideDistance=-this.scaleValue:n<0&&(this.slideDistance=-s*this.scaleValue),this.setTranslate())}getSize(){const{direction:e,root:t}=this,{width:i=0,height:s=0}=t.getBoundingClientRect();return"vertical"===e?s:i}getMaxSlideDistance(){const e=this.getSize();return this.getSlideContentSize()-e}getSlideContentSize(){const{slideList:e,direction:t}=this;let i=0;for(let s=0;s<e.length;s++){const n=e[s],{width:a,height:o}=n.getBoundingClientRect();i+="vertical"===t?o:a}return i}startAnimation(e,t,i=30,s){let n=e;const a=t;let o;const l=new Promise((e=>o=e)),h=()=>{n<a?(n+=i,n>=a&&(n=a)):n>a&&(n-=i,n<=a&&(n=a)),s(n),e>t&&(n>a?this.animateId=window.requestAnimationFrame(h):o()),e<t&&(n<a?this.animateId=window.requestAnimationFrame(h):o())};return this.animateId=window.requestAnimationFrame(h),l}cancelAnimation(){window.cancelAnimationFrame(this.animateId)}}e.createSlide=e=>new n(e),e.createTouch=s,Object.defineProperty(e,"__esModule",{value:!0})}));
